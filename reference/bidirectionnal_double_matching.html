<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Match Trees Between Measured and Inventory Maps Using 3D 2-Nearest Neighbors — bidirectionnal_double_matching • TreeMatching</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Match Trees Between Measured and Inventory Maps Using 3D 2-Nearest Neighbors — bidirectionnal_double_matching"><meta property="og:description" content="This function performs a bidirectional 3D 2-nearest-neighbors matching between two sets of trees.
It is bidirectional because it performs an inventory to measure matching and a measure to
inventory matching. It used 2-nearest-neighbors instead of 1-nearest-neighbors to give a chance to
each tree to get matched twice so each tree as a fall back matching reducing probabilities of collision
and therefore ommission and commission between from trees that would be matched to the same reference
using a 1-nn approach.
It uses a scaled 3D distance (based on X, Y, and DBH as a proxy for Z) to identify the best match
for each tree in both directions. The final match is the most consistent and closest association
between the two sets."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TreeMatching</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Tutorial.html">Tutorial</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Match Trees Between Measured and Inventory Maps Using 3D 2-Nearest Neighbors</h1>

    <div class="hidden name"><code>bidirectionnal_double_matching.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function performs a bidirectional 3D 2-nearest-neighbors matching between two sets of trees.
It is bidirectional because it performs an inventory to measure matching and a measure to
inventory matching. It used 2-nearest-neighbors instead of 1-nearest-neighbors to give a chance to
each tree to get matched twice so each tree as a fall back matching reducing probabilities of collision
and therefore ommission and commission between from trees that would be matched to the same reference
using a 1-nn approach.<br><br>
It uses a scaled 3D distance (based on X, Y, and DBH as a proxy for Z) to identify the best match
for each tree in both directions. The final match is the most consistent and closest association
between the two sets.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bidirectionnal_double_matching</span><span class="op">(</span><span class="va">treemap</span>, dxymax <span class="op">=</span> <span class="fl">2</span>, dzmax <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-treemap">treemap<a class="anchor" aria-label="anchor" href="#arg-treemap"></a></dt>
<dd><p>A `TreeMapMatching` object created with [make_mapmatching()], containing the `inventory`,
`measured`, `center`, and `radius`.</p></dd>


<dt id="arg-dxymax">dxymax<a class="anchor" aria-label="anchor" href="#arg-dxymax"></a></dt>
<dd><p>Maximum allowed horizontal (XY) distance for matching. Default is 2.</p></dd>


<dt id="arg-dzmax">dzmax<a class="anchor" aria-label="anchor" href="#arg-dzmax"></a></dt>
<dd><p>Maximum allowed vertical (Z/DBH) difference. Default is 0.1.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A `data.table` with two columns:</p><dl><dt>index_measure</dt>
<dd><p>Index of the measured tree</p></dd>

  <dt>index_inventory</dt>
<dd><p>Index of the matched inventory tree, or `NA` if no match was found</p></dd>


</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The algorithm works in two passes:</p><ol><li><p>From measured trees to inventory: for each measured tree, it finds its two closest neighbors
        in the inventory using 3D Euclidean distance. The third dimension (Z) is synthesized from the DBH
        (diameter at breast height), scaled to be comparable with X and Y.</p></li>
<li><p>From inventory to measured: the same process is repeated in reverse.</p></li>
</ol><p>For both passes, only matches within a maximum distance (`dxymax`) in the X/Y plane and a maximum DBH
difference (`dzmax`) are retained. Each inventory tree can only be assigned to one measured tree
(and vice versa), to prevent duplicates.<br><br>
If a tree has two possible matches (one in each direction), the closest in full 3D distance is chosen.
In case of ambiguous matches (i.e., multiple measured trees selecting the same inventory tree), the
one with the shortest 3D distance is kept, and the others are discarded.<br><br>
This approach is particularly useful when traditional 2D proximity does not yield reliable matches
due to spatial shifts and inaccuracies. The use of DBH as a proxy for vertical position improves
the separation of nearby stems.</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jean-Romain Roussel.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

