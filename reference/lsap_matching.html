<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Match measured and inventory trees solving LSAP — lsap_matching • TreeMatching</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Match measured and inventory trees solving LSAP — lsap_matching"><meta property="og:description" content="Matches trees from a LiDAR-derived dataset (e.g., ALS or TLS) to trees from a field inventory
by solving a Linear Sum Assignment Problem (LSAP) in 3D space. The third dimension (Z)
is artificially constructed from DBH or tree height to improve the accuracy of positional matching.
To allow partial matching (i.e., unmatched trees), dummy trees are added with a fixed cost
(unmatch_cost). This prevents the algorithm from forcing poor matches."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TreeMatching</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Tutorial.html">Tutorial</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Match measured and inventory trees solving LSAP</h1>

    <div class="hidden name"><code>lsap_matching.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Matches trees from a LiDAR-derived dataset (e.g., ALS or TLS) to trees from a field inventory
by solving a Linear Sum Assignment Problem (LSAP) in 3D space. The third dimension (Z)
is artificially constructed from DBH or tree height to improve the accuracy of positional matching.
To allow partial matching (i.e., unmatched trees), dummy trees are added with a fixed cost
(<code>unmatch_cost</code>). This prevents the algorithm from forcing poor matches.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">lsap_matching</span><span class="op">(</span></span>
<span>  <span class="va">treemap</span>,</span>
<span>  dxymax <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  dzmax <span class="op">=</span> <span class="fl">40</span>,</span>
<span>  zrel <span class="op">=</span> <span class="fl">40</span>,</span>
<span>  unmatch_cost <span class="op">=</span> <span class="st">"auto"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">guess_unmatch_cost</span><span class="op">(</span><span class="va">treemap</span>, <span class="va">dxymax</span>, <span class="va">dzmax</span>, <span class="va">zrel</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">lsap_app</span><span class="op">(</span><span class="va">treemap</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-treemap">treemap<a class="anchor" aria-label="anchor" href="#arg-treemap"></a></dt>
<dd><p>A <code>TreeMapMatching</code> object. See <a href="make_mapmatching.html">make_mapmatching</a>.</p></dd>


<dt id="arg-dxymax">dxymax<a class="anchor" aria-label="anchor" href="#arg-dxymax"></a></dt>
<dd><p>Maximum allowed 2D (XY) distance (in projection units) for a valid match.</p></dd>


<dt id="arg-dzmax">dzmax<a class="anchor" aria-label="anchor" href="#arg-dzmax"></a></dt>
<dd><p>Maximum allowed Z difference (e.g., DBH or height) in % for a valid match. Be careful
the difference is expressed in %. Default is 40%. A 10 cm DBH tree can be matched with tree in
6, 14 cm (10 +/- 40% of 10).</p></dd>


<dt id="arg-zrel">zrel<a class="anchor" aria-label="anchor" href="#arg-zrel"></a></dt>
<dd><p>Relative importance of the Z dimension compared to XY. Since Z and XY units differ,
Z is scaled to be comparable. A value of 0 means Z is ignored; a value of 1 gives Z and XY equal
weights. Default is 40%.</p></dd>


<dt id="arg-unmatch-cost">unmatch_cost<a class="anchor" aria-label="anchor" href="#arg-unmatch-cost"></a></dt>
<dd><p>Fixed cost of assigning a tree to a dummy (i.e., unmatched). See Details.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>unused</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A <code>data.table</code> with the following columns:</p><dl><dt><code>index_measure</code></dt>
<dd><p>Index of the matched tree in the measured (LiDAR) dataset.</p></dd>

<dt><code>index_inventory</code></dt>
<dd><p>Index of the matched tree in the inventory dataset, or <code>NA</code> if unmatched.</p></dd>


</dl><p>Only matches that satisfy the distance thresholds are returned. Invalid matches are marked as <code>NA</code>.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function computes a matching between trees in a 3D space, where Z is not an actual height
but a synthetic dimension created from DBH (or tree height). The goal is to improve discrimination
between nearby trees of different sizes. Because DBH and spatial coordinates (XY) are not directly
comparable, the Z dimension is scaled using the <code>zrel</code> parameter.<br><br>
Matching is performed solving LSAP using Hungarian algorithm via <a href="https://rdrr.io/pkg/clue/man/solve_LSAP.html" class="external-link">solve_LSAP</a>,
which finds the lowest-cost one-to-one pairings. However, LSAP matches all items by default,
even when no good match exists. To avoid poor assignments, dummy trees are introduced in the cost
matrix with a fixed cost (<code>unmatch_cost</code>).<br><br>'
If the cost of a match exceeds <code>unmatch_cost</code>, the algorithm prefers leaving the tree unmatched.
These unmatched entries are then returned with <code>index_inventory = NA</code>.<br><br>
Choosing a good value for <code>unmatch_cost</code> is important:</p><ul><li><p>It must be <strong>higher than the cost of a good match</strong>, to allow valid pairings.</p></li>
<li><p>It must be <strong>lower than the cost of a bad match</strong>, to avoid forced poor pairings.</p></li>
</ul><p>When <code>unmatch_cost = "auto"</code>, a simple heuristic is used to estimate a reasonable value,
which is printed to the console. Users can refine this value manually if needed.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="https://rdrr.io/pkg/clue/man/solve_LSAP.html" class="external-link">solve_LSAP</a>, <a href="make_mapmatching.html">make_mapmatching</a>, <a href="match_trees.html">match_trees</a></p></div>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jean-Romain Roussel.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

